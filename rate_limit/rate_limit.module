<?php

/**
 * Implements hook_cron().
 *
 * Deletes expired log entries.
 */
function rate_limit_cron() {
  $expire = variable_get('rate_limit_log_expire_after', 0);
  if ($expire) {
    $limit = time() - $expire;
    db_delete('rate_limit_log')->condition('timestamp', $limit, '<')->execute();
  }
}
