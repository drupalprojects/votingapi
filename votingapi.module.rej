***************
*** 264,270 ****
      foreach ($votes as $vote) {
        $vids[] = $vote['vote_id'];
      }
-     db_delete('votingapi_vote')->condition('vote_id', $vids, 'IN')->execute();
    }
  }
  
--- 293,300 ----
      foreach ($votes as $vote) {
        $vids[] = $vote['vote_id'];
      }
+     $function = variable_get('votingapi_storage_module', 'votingapi') . '_votingapi_storage_delete_votes';
+     $function($votes, $vids);
    }
  }
  
***************
*** 310,323 ****
    if (!empty($criteria['vote_source']) && $anon_window > 0) {
      $criteria['timestamp'] = REQUEST_TIME - $anon_window;
    }
-   $query = db_select('votingapi_vote')->fields('votingapi_vote');
-   foreach ($criteria as $key => $value) {
-     $query->condition($key, $value, is_array($value) ? 'IN' : '=');
-   }
-   if (!empty($limit)) {
-     $query->range(0, $limit);
-   }
-   return $query->execute()->fetchAll(PDO::FETCH_ASSOC);
  }
  
  /**
--- 340,347 ----
    if (!empty($criteria['vote_source']) && $anon_window > 0) {
      $criteria['timestamp'] = REQUEST_TIME - $anon_window;
    }
+   $function = variable_get('votingapi_storage_module', 'votingapi') . '_votingapi_storage_select_votes';
+   return $function($criteria, $limit);
  }
  
  /**
***************
*** 378,386 ****
        ->condition('entity_type', $entity_type)
        ->condition('entity_id', $entity_id)
        ->execute();
-       
      // Bulk query to pull the majority of the results we care about.
-     $cache = _votingapi_get_standard_results($entity_type, $entity_id);
  
      // Give other modules a chance to alter the collection of votes.
      drupal_alter('votingapi_results', $cache, $entity_type, $entity_id);
--- 402,411 ----
        ->condition('entity_type', $entity_type)
        ->condition('entity_id', $entity_id)
        ->execute();
+ 
+     $function = variable_get('votingapi_storage_module', 'votingapi') . '_votingapi_storage_standard_results';
      // Bulk query to pull the majority of the results we care about.
+     $cache = $function($entity_type, $entity_id);
  
      // Give other modules a chance to alter the collection of votes.
      drupal_alter('votingapi_results', $cache, $entity_type, $entity_id);
***************
*** 478,484 ****
  /**
   * Builds the default VotingAPI results for the three supported voting styles.
   */
- function _votingapi_get_standard_results($entity_type, $entity_id) {
    $cache = array();
  
    $sql  = "SELECT v.value_type, v.tag, ";
--- 503,509 ----
  /**
   * Builds the default VotingAPI results for the three supported voting styles.
   */
+ function votingapi_votingapi_storage_standard_results($entity_type, $entity_id) {
    $cache = array();
  
    $sql  = "SELECT v.value_type, v.tag, ";
***************
*** 549,552 ****
        'prepped' => TRUE
      );
    }
- }--- 574,577 ----
        'prepped' => TRUE
      );
    }
+ }
